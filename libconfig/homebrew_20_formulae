#!/bin/bash -e

installed_formulae="$(brew list)"

formula_not_installed?() {
  local formula="${1:?formula must be provided}"

  ! grep "$formula" >&- <<< "$installed_formulae"
}

pushd "${BASE_PATH}/homebrew/formulae" >&-
  for formula in *
  do
    if formula_not_installed? "$formula"
    then
      formula_options="$(cat "$formula")"
      bash -c "brew install $formula $formula_options"
    fi
  done
popd >&-
